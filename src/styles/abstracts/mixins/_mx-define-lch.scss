/// @group Abstracts/Mixins
/// @name LCH Color Utilities
///
/// Mixins for defining LCH color values as CSS custom properties.
/// Extracts and converts Sass color values to LCH format for use in :root.
///
/// @example scss
///   :root {
///     @include define-lch($color-primary, --color-primary);
///     @include define-adjusted-lch($color-accent, --color-accent-hover, -15);
///   }

@use "sass:color";
@use "sass:math";
@use "sass:string";

/// Define a base LCH color from a Sass color variable
///
/// @param {Color} $base-color - Sass color value (hex, rgb, etc.)
/// @param {String} $css-var-name - CSS custom property name (with --)
///
/// @example scss
///   @include define-lch(#E4DCCA, --color-accent);
///   // Output: --color-accent: lch(90% 15 85);

@mixin define-lch($base-color, $css-var-name) {
  $l: math.div(color.channel($base-color, "lightness", $space: lch), 1%);
  $c: math.div(color.channel($base-color, "chroma", $space: lch), 1);
  $h: math.div(color.channel($base-color, "hue", $space: lch), 1deg);

  #{$css-var-name}: string.unquote("lch(#{$l}% #{$c} #{$h})");
}

/// Define an LCH color with alpha transparency
///
/// @param {Color} $base-color - Sass color value (hex, rgb, etc.)
/// @param {String} $css-var-name - CSS custom property name (with --)
/// @param {Number} $alpha - Alpha value (0 to 1)
///
/// @example scss
///   @include define-lch-alpha(#201715, --color-overlay-medium, 0.65);
///   // Output: --color-overlay-medium: lch(10% 5 30 / 0.65);

@mixin define-lch-alpha($base-color, $css-var-name, $alpha: 1) {
  $l: math.div(color.channel($base-color, "lightness", $space: lch), 1%);
  $c: math.div(color.channel($base-color, "chroma", $space: lch), 1);
  $h: math.div(color.channel($base-color, "hue", $space: lch), 1deg);

  #{$css-var-name}: string.unquote("lch(#{$l}% #{$c} #{$h} / #{$alpha})");
}

/// Define an adjusted LCH color with modified lightness
///
/// @param {Color} $base-color - Sass color value (hex, rgb, etc.)
/// @param {String} $css-var-name - CSS custom property name (with --)
/// @param {Number} $l-adjustment - Lightness adjustment (-100 to 100)
/// @param {Number} $c-adjustment - Chroma adjustment (0-1)
///
/// @example scss
///   @include define-adjusted-lch(#E4DCCA, --color-accent-hover, -15);
///   // Output: --color-accent-hover: lch(75% 15 85);
///
/// @example scss
///   @include define-adjusted-lch(#E4DCCA, --color-accent-hover, -15, 0.3);
///   // Output: --color-accent-hover: lch(86% 16.8 142);

@mixin define-adjusted-lch(
  $base-color,
  $css-var-name,
  $l-adjustment: 0,
  $c-multiplier: 1
) {
  $l: math.div(color.channel($base-color, "lightness", $space: lch), 1%);
  $c: math.div(color.channel($base-color, "chroma", $space: lch), 1);
  $h: math.div(color.channel($base-color, "hue", $space: lch), 1deg);

  $l-adjusted: $l + $l-adjustment;
  $c-adjusted: $c * $c-multiplier;

  #{$css-var-name}: string.unquote("lch(#{$l-adjusted}% #{$c-adjusted} #{$h})");
}
/// Define an adjusted LCH color with lightness adjustment AND alpha
///
/// @param {Color} $base-color - Sass color value
/// @param {String} $css-var-name - CSS custom property name
/// @param {Number} $l-adjustment - Lightness adjustment (-100 to 100)
/// @param {Number} $alpha - Alpha value (0 to 1)
///
/// @example scss
///   @include define-adjusted-lch-alpha(#009700, --color-success-bg, 40, 0.2);
///   // Output: --color-success-bg: lch(86% 17 142 / 0.2);

@mixin define-adjusted-lch-alpha(
  $base-color,
  $css-var-name,
  $l-adjustment: 0,
  $alpha: 1
) {
  $l: math.div(color.channel($base-color, "lightness", $space: lch), 1%);
  $c: math.div(color.channel($base-color, "chroma", $space: lch), 1);
  $h: math.div(color.channel($base-color, "hue", $space: lch), 1deg);

  $l-adjusted: $l + $l-adjustment;

  #{$css-var-name}: string.unquote(
    "lch(#{$l-adjusted}% #{$c} #{$h} / #{$alpha})"
  );
}
